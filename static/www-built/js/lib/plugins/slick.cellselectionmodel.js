(function(f,h){"function"===typeof define&&define.amd?define(["jquery","../slick.core","./slick.cellrangeselector"],h):f.Slick.CellSelectionModel=h(f.jQuery,f.Slick,f.Slick.CellRangeSelector)})(this,function(f,h,z){return function(w){function p(a){for(var c=[],d=0;d<a.length;d++){var b=a[d];e.canCellBeSelected(b.fromRow,b.fromCell)&&e.canCellBeSelected(b.toRow,b.toCell)&&c.push(b)}return c}function m(a){if(k&&0!==k.length||a&&0!==a.length)k=p(a),x.onSelectedRangesChanged.notify(k)}function q(a,c){if(e.getEditorLock().isActive())return a.stopPropagation(),
!1}function r(a,c){m([c.range])}function t(a,c){u.selectActiveCell&&null!=c.row&&null!=c.cell&&m([new h.Range(c.row,c.cell)])}function v(a){var c,d,b=e.getActiveCell();if(b&&a.shiftKey&&!a.ctrlKey&&!a.altKey&&(37==a.which||39==a.which||38==a.which||40==a.which)){c=k;c.length||c.push(new h.Range(b.row,b.cell));d=c.pop();d.contains(b.row,b.cell)||(d=new h.Range(b.row,b.cell));var f=d.toRow-d.fromRow,g=d.toCell-d.fromCell,n=b.row==d.fromRow?1:-1,l=b.cell==d.fromCell?1:-1;37==a.which?g-=l:39==a.which?
g+=l:38==a.which?f-=n:40==a.which&&(f+=n);b=new h.Range(b.row,b.cell,b.row+n*f,b.cell+l*g);p([b]).length?(c.push(b),d=0<n?b.toRow:b.fromRow,l=0<l?b.toCell:b.fromCell,e.scrollRowIntoView(d),e.scrollCellIntoView(d,l)):c.push(d);m(c);a.preventDefault();a.stopPropagation()}}var e,k=[],x=this,g=new h.CellRangeSelector({selectionCss:{border:"2px solid black"}}),u,y={selectActiveCell:!0};f.extend(this,{getSelectedRanges:function(){return k},setSelectedRanges:m,init:function(a){u=f.extend(!0,{},y,w);e=a;
e.getCanvasNode();e.onActiveCellChanged.subscribe(t);e.onKeyDown.subscribe(v);a.registerPlugin(g);g.onCellRangeSelected.subscribe(r);g.onBeforeCellRangeSelected.subscribe(q)},destroy:function(){e.onActiveCellChanged.unsubscribe(t);e.onKeyDown.unsubscribe(v);g.onCellRangeSelected.unsubscribe(r);g.onBeforeCellRangeSelected.unsubscribe(q);e.unregisterPlugin(g)},onSelectedRangesChanged:new h.Event})}});