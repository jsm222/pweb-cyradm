(function(e,h){"function"===typeof define&&define.amd?define(["jquery","../slick.core","./slick.cellrangeselector"],h):e.Slick.CellSelectionModel=h(e.jQuery,e.Slick,e.Slick.CellRangeSelector)})(this,function(e,h,w){return function(x){function p(b){for(var c=[],d=0;d<b.length;d++){var a=b[d];f.canCellBeSelected(a.fromRow,a.fromCell)&&f.canCellBeSelected(a.toRow,a.toCell)&&c.push(a)}return c}function l(b){m=p(b);y.onSelectedRangesChanged.notify(m)}function q(b,c){if(f.getEditorLock().isActive())return b.stopPropagation(),
!1}function r(b,c){l([c.range])}function t(b,c){u.selectActiveCell&&null!=c.row&&null!=c.cell&&l([new h.Range(c.row,c.cell)])}function v(b){var c,d,a=f.getActiveCell();if(a&&b.shiftKey&&!b.ctrlKey&&!b.altKey&&(37==b.which||39==b.which||38==b.which||40==b.which)){c=m;c.length||c.push(new h.Range(a.row,a.cell));d=c.pop();d.contains(a.row,a.cell)||(d=new h.Range(a.row,a.cell));var e=d.toRow-d.fromRow,g=d.toCell-d.fromCell,n=a.row==d.fromRow?1:-1,k=a.cell==d.fromCell?1:-1;37==b.which?g-=k:39==b.which?
g+=k:38==b.which?e-=n:40==b.which&&(e+=n);a=new h.Range(a.row,a.cell,a.row+n*e,a.cell+k*g);p([a]).length?(c.push(a),d=0<n?a.toRow:a.fromRow,k=0<k?a.toCell:a.fromCell,f.scrollRowIntoView(d),f.scrollCellIntoView(d,k)):c.push(d);l(c);b.preventDefault();b.stopPropagation()}}var f,m=[],y=this,g=new w({selectionCss:{border:"2px solid black"}}),u,z={selectActiveCell:!0};e.extend(this,{getSelectedRanges:function(){return m},setSelectedRanges:l,init:function(b){u=e.extend(!0,{},z,x);f=b;f.getCanvasNode();
f.onActiveCellChanged.subscribe(t);f.onKeyDown.subscribe(v);b.registerPlugin(g);g.onCellRangeSelected.subscribe(r);g.onBeforeCellRangeSelected.subscribe(q)},destroy:function(){f.onActiveCellChanged.unsubscribe(t);f.onKeyDown.unsubscribe(v);g.onCellRangeSelected.unsubscribe(r);g.onBeforeCellRangeSelected.unsubscribe(q);f.unregisterPlugin(g)},onSelectedRangesChanged:new h.Event})}});