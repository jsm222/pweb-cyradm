(function(v,t){"function"===typeof define&&define.amd?define(["jquery","./slick.core","jquery.event/drag"],t):(v.Slick.Data=v.Slick.Data||{},v.Slick.Data.Dataview=t(v.jQuery,v.Slick))})(this,function(v,t){function H(m){function c(a){for(var b=a||0,d=f.length;b<d;b++){a=f[b][y];if(void 0===a)throw"Each data element must implement a unique 'id' property";w[a]=b}}function Q(){return{pageSize:p,pageNum:z,totalRows:A,totalPages:p?Math.max(1,Math.ceil(A/p)):1,dataView:C}}function H(a,b){J=b;K=a;L=null;
!1===b&&f.reverse();f.sort(a);!1===b&&f.reverse();w={};c();q()}function W(a,b){J=b;L=a;K=null;var d=Object.prototype.toString;Object.prototype.toString="function"==typeof a?a:function(){return this[a]};!1===b&&f.reverse();f.sort();Object.prototype.toString=d;!1===b&&f.reverse();w={};c();q()}function M(a){m.groupItemMetadataProvider||(m.groupItemMetadataProvider=new t.Data.GroupItemMetadataProvider);D=[];F=[];a=a||[];h=a instanceof Array?a:[a];for(a=0;a<h.length;a++){var b=h[a]=v.extend(!0,{},ha,h[a]);
b.getterIsAFn="function"===typeof b.getter;b.compiledAccumulators=[];for(var d=b.aggregators.length;d--;){var ia=b.compiledAccumulators,e=d,c=R(b.aggregators[d].accumulate),c=new Function("_items","for (var "+c.params[0]+", _i\x3d0, _il\x3d_items.length; _i\x3c_il; _i++) {"+c.params[0]+" \x3d _items[_i]; "+c.body+"}");c.displayName=c.name="compiledAccumulatorLoop";ia[e]=c}F[a]={}}q()}function S(){if(!E){E={};for(var a=0,b=u.length;a<b;a++)E[u[a][y]]=a}}function X(a,b){if(null==a)for(var d=0;d<h.length;d++)F[d]=
{},h[d].collapsed=b;else F[a]={},h[a].collapsed=b;q()}function N(a,b,d){F[a][b]=h[a].collapsed^d;q()}function Y(a,b){for(var d,c,e=[],k={},g,l=b?b.level+1:0,I=h[l],n=0,f=I.predefinedValues.length;n<f;n++)c=I.predefinedValues[n],d=k[c],d||(d=new t.Group,d.value=c,d.level=l,d.groupingKey=(b?b.groupingKey+":|:":"")+c,e[e.length]=d,k[c]=d);n=0;for(f=a.length;n<f;n++)g=a[n],c=I.getterIsAFn?I.getter(g):g[I.getter],d=k[c],d||(d=new t.Group,d.value=c,d.level=l,d.groupingKey=(b?b.groupingKey+":|:":"")+c,e[e.length]=
d,k[c]=d),d.rows[d.count++]=g;if(l<h.length-1)for(n=0;n<e.length;n++)d=e[n],d.groups=Y(d.rows,d);e.sort(h[l].comparer);return e}function O(a){var b=a.group,d=h[b.level],c=b.level==h.length,e,k=d.aggregators.length;if(!c&&d.aggregateChildGroups)for(e=b.groups.length;e--;)b.groups[e].totals.initialized||O(b.groups[e].totals);for(;k--;)e=d.aggregators[k],e.init(),!c&&d.aggregateChildGroups?d.compiledAccumulators[k].call(e,b.groups):d.compiledAccumulators[k].call(e,b.rows),e.storeResult(a);a.initialized=
!0}function Z(a,b){b=b||0;for(var d=h[b],c=d.collapsed,e=F[b],k=a.length,g;k--;)if(g=a[k],!g.collapsed||d.aggregateCollapsed){g.groups&&Z(g.groups,b+1);if(d.aggregators.length&&(d.aggregateEmpty||g.rows.length||g.groups&&g.groups.length)){var l=g,f=h[l.level],n=new t.GroupTotals;n.group=l;l.totals=n;f.lazyTotalsCalculation||O(n)}g.collapsed=c^e[g.groupingKey];g.title=d.formatter?d.formatter(g):g.value}}function aa(a,b){b=b||0;for(var d=h[b],c=[],e,k=0,g,l=0,f=a.length;l<f;l++){g=a[l];c[k++]=g;if(!g.collapsed){e=
g.groups?aa(g.groups,b+1):g.rows;for(var n=0,m=e.length;n<m;n++)c[k++]=e[n]}g.totals&&d.displayTotalsRow&&(!g.collapsed||d.aggregateCollapsed)&&(c[k++]=g.totals)}return c}function R(a){a=a.toString().match(/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/);return{params:a[1].split(","),body:a[2]}}function ja(a,b){for(var d=[],c=0,e=0,k=a.length;e<k;e++)B(a[e],b)&&(d[c++]=a[e]);return d}function ka(a,b,d){for(var c=[],e=0,k,g=0,l=a.length;g<l;g++)k=a[g],d[g]?c[e++]=k:B(k,b)&&(c[e++]=k,d[g]=!0);return c}function ba(a){E=
null;if(r.isFilterNarrowing!=T.isFilterNarrowing||r.isFilterExpanding!=T.isFilterExpanding)ca=[];if(B){var b=m.inlineFilters?da:ja,d=m.inlineFilters?ea:ka;r.isFilterNarrowing?x=b(x,P):r.isFilterExpanding?x=d(a,P,ca):r.isFilterUnchanged||(x=b(a,P))}else x=p?a:a.concat();p?(x.length<z*p&&(z=Math.floor(x.length/p)),b=x.slice(p*z,p*z+p)):b=x;A=a=x.length;a=b;D=[];h.length&&(D=Y(a),D.length&&(Z(D),a=aa(D)));var b=u,d=a,c,e,k,g=[];c=0;var l=d.length;r&&r.ignoreDiffsBefore&&(c=Math.max(0,Math.min(d.length,
r.ignoreDiffsBefore)));r&&r.ignoreDiffsAfter&&(l=Math.min(d.length,Math.max(0,r.ignoreDiffsAfter)));for(var f=c,n=b.length;f<l;f++)if(f>=n)g[g.length]=f;else if(c=d[f],e=b[f],h.length&&(k=c.__nonDataRow||e.__nonDataRow)&&c.__group!==e.__group||c.__group&&!c.equals(e)||k&&(c.__groupTotals||e.__groupTotals)||c[y]!=e[y]||G&&G[c[y]])g[g.length]=f;u=a;return g}function q(){if(!U){var a=u.length,b=A,c=ba(f,B);p&&A<z*p&&(z=Math.max(0,Math.ceil(A/p)-1),c=ba(f,B));G=null;T=r;r={};b!==A&&V.notify(Q(),null,
C);a!==u.length&&fa.notify({previous:a,current:u.length,dataView:C},null,C);0<c.length&&ga.notify({rows:c,dataView:C},null,C)}}var C=this,y="id",f=[],u=[],w={},E=null,B=null,G=null,U=!1,J=!0,L,K,r={},T={},P,x=[],da,ea,ca=[],ha={getter:null,formatter:null,comparer:function(a,b){return a.value===b.value?0:a.value>b.value?1:-1},predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},h=[],D=[],F=[],p=
0,z=0,A=0,fa=new t.Event,ga=new t.Event,V=new t.Event;m=v.extend(!0,{},{groupItemMetadataProvider:null,inlineFilters:!1},m);v.extend(this,{beginUpdate:function(){U=!0},endUpdate:function(){U=!1;q()},setPagingOptions:function(a){void 0!=a.pageSize&&(z=(p=a.pageSize)?Math.min(z,Math.max(0,Math.ceil(A/p)-1)):0);void 0!=a.pageNum&&(z=Math.min(a.pageNum,Math.max(0,Math.ceil(A/p)-1)));V.notify(Q(),null,C);q()},getPagingInfo:Q,getItems:function(){return f},setItems:function(a,b){void 0!==b&&(y=b);f=x=a;
w={};c();for(var d,h=0,e=f.length;h<e;h++)if(d=f[h][y],void 0===d||w[d]!==h)throw"Each data element must implement a unique 'id' property";q()},setFilter:function(a){B=a;if(m.inlineFilters){a=R(B);var b=a.body.replace(/return false\s*([;}]|\}|$)/gi,"{ continue _coreloop; }$1").replace(/return!1([;}]|\}|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|\}|$)/gi,"{ _retval[_idx++] \x3d $item$; continue _coreloop; }$1").replace(/return!0([;}]|\}|$)/gi,"{ _retval[_idx++] \x3d $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,
"{ if ($1) { _retval[_idx++] \x3d $item$; }; continue _coreloop; }$2"),b="var _retval \x3d [], _idx \x3d 0; var $item$, $args$ \x3d _args; _coreloop: for (var _i \x3d 0, _il \x3d _items.length; _i \x3c _il; _i++) { $item$ \x3d _items[_i]; $filter$; } return _retval; ".replace(/\$filter\$/gi,b),b=b.replace(/\$item\$/gi,a.params[0]),b=b.replace(/\$args\$/gi,a.params[1]);a=new Function("_items,_args",b);a.displayName=a.name="compiledFilter";da=a;a=R(B);b=a.body.replace(/return false\s*([;}]|\}|$)/gi,
"{ continue _coreloop; }$1").replace(/return!1([;}]|\}|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|\}|$)/gi,"{ _cache[_i] \x3d true;_retval[_idx++] \x3d $item$; continue _coreloop; }$1").replace(/return!0([;}]|\}|$)/gi,"{ _cache[_i] \x3d true;_retval[_idx++] \x3d $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] \x3d $1)) { _retval[_idx++] \x3d $item$; }; continue _coreloop; }$2");b="var _retval \x3d [], _idx \x3d 0; var $item$, $args$ \x3d _args; _coreloop: for (var _i \x3d 0, _il \x3d _items.length; _i \x3c _il; _i++) { $item$ \x3d _items[_i]; if (_cache[_i]) { _retval[_idx++] \x3d $item$; continue _coreloop; } $filter$; } return _retval; ".replace(/\$filter\$/gi,
b);b=b.replace(/\$item\$/gi,a.params[0]);b=b.replace(/\$args\$/gi,a.params[1]);a=new Function("_items,_args,_cache",b);a.displayName=a.name="compiledFilterWithCaching";ea=a}q()},sort:H,fastSort:W,reSort:function(){K?H(K,J):L&&W(L,J)},setGrouping:M,getGrouping:function(){return h},groupBy:function(a,b,c){null==a?M([]):M({getter:a,formatter:b,comparer:c})},setAggregators:function(a,b){if(!h.length)throw Error("At least one grouping must be specified before calling setAggregators().");h[0].aggregators=
a;h[0].aggregateCollapsed=b;M(h)},collapseAllGroups:function(a){X(a,!0)},expandAllGroups:function(a){X(a,!1)},collapseGroup:function(a){var b=Array.prototype.slice.call(arguments),c=b[0];1==b.length&&-1!=c.indexOf(":|:")?N(c.split(":|:").length-1,c,!0):N(b.length-1,b.join(":|:"),!0)},expandGroup:function(a){var b=Array.prototype.slice.call(arguments),c=b[0];1==b.length&&-1!=c.indexOf(":|:")?N(c.split(":|:").length-1,c,!1):N(b.length-1,b.join(":|:"),!1)},getGroups:function(){return D},getIdxById:function(a){return w[a]},
getRowById:function(a){S();return E[a]},getItemById:function(a){return f[w[a]]},getItemByIdx:function(a){return f[a]},mapRowsToIds:function(a){for(var b=[],c=0,f=a.length;c<f;c++)a[c]<u.length&&(b[b.length]=u[a[c]][y]);return b},mapIdsToRows:function(a){var b=[];S();for(var c=0,f=a.length;c<f;c++){var e=E[a[c]];null!=e&&(b[b.length]=e)}return b},setRefreshHints:function(a){r=a},setFilterArgs:function(a){P=a},refresh:q,updateItem:function(a,b){if(void 0===w[a]||a!==b[y])throw"Invalid or non-matching id";
f[w[a]]=b;G||(G={});G[a]=!0;q()},insertItem:function(a,b){f.splice(a,0,b);c(a);q()},addItem:function(a){f.push(a);c(f.length-1);q()},deleteItem:function(a){var b=w[a];if(void 0===b)throw"Invalid id";delete w[a];f.splice(b,1);c(b);q()},syncGridSelection:function(a,b,c){function f(b){l.join(",")!=b.join(",")&&(l=b,h.notify({grid:a,ids:l,dataView:k},new t.EventData,k))}function e(){if(0<l.length){g=!0;var c=k.mapIdsToRows(l);b||f(k.mapRowsToIds(c));a.setSelectedRows(c);g=!1}}var k=this,g,l=k.mapRowsToIds(a.getSelectedRows()),
h=new t.Event;a.onSelectedRowsChanged.subscribe(function(b,e){if(!g){var h=k.mapRowsToIds(a.getSelectedRows());if(c&&a.getOptions().multiSelect){var m=v.grep(l,function(a){return void 0===k.getRowById(a)});f(m.concat(h))}else f(h)}});this.onRowsChanged.subscribe(e);this.onRowCountChanged.subscribe(e);return h},syncGridCellCssStyles:function(a,b){function c(a){e={};for(var b in a)e[u[b][y]]=a[b]}function f(){if(e){k=!0;S();var c={},d;for(d in e){var h=E[d];void 0!=h&&(c[h]=e[d])}a.setCellCssStyles(b,
c);k=!1}}var e,k;c(a.getCellCssStyles(b));a.onCellCssStylesChanged.subscribe(function(a,e){k||b==e.key&&e.hash&&c(e.hash)});this.onRowsChanged.subscribe(f);this.onRowCountChanged.subscribe(f)},getLength:function(){return u.length},getItem:function(a){if((a=u[a])&&a.__group&&a.totals&&!a.totals.initialized){var b=h[a.level];b.displayTotalsRow||(O(a.totals),a.title=b.formatter?b.formatter(a):a.value)}else a&&a.__groupTotals&&!a.initialized&&O(a);return a},getItemMetadata:function(a){a=u[a];return void 0===
a?null:a.__group?m.groupItemMetadataProvider.getGroupRowMetadata(a):a.__groupTotals?m.groupItemMetadataProvider.getTotalsRowMetadata(a):null},onRowCountChanged:fa,onRowsChanged:ga,onPagingInfoChanged:V})}v.extend(!0,t,{Data:{DataView:H,Aggregators:{Avg:function(m){this.field_=m;this.init=function(){this.sum_=this.nonNullCount_=this.count_=0};this.accumulate=function(c){c=c[this.field_];this.count_++;null==c||""===c||isNaN(c)||(this.nonNullCount_++,this.sum_+=parseFloat(c))};this.storeResult=function(c){c.avg||
(c.avg={});0!=this.nonNullCount_&&(c.avg[this.field_]=this.sum_/this.nonNullCount_)}},Min:function(m){this.field_=m;this.init=function(){this.min_=null};this.accumulate=function(c){c=c[this.field_];null!=c&&""!==c&&!isNaN(c)&&(null==this.min_||c<this.min_)&&(this.min_=c)};this.storeResult=function(c){c.min||(c.min={});c.min[this.field_]=this.min_}},Max:function(m){this.field_=m;this.init=function(){this.max_=null};this.accumulate=function(c){c=c[this.field_];null!=c&&""!==c&&!isNaN(c)&&(null==this.max_||
c>this.max_)&&(this.max_=c)};this.storeResult=function(c){c.max||(c.max={});c.max[this.field_]=this.max_}},Sum:function(m){this.field_=m;this.init=function(){this.sum_=null};this.accumulate=function(c){c=c[this.field_];null==c||""===c||isNaN(c)||(this.sum_+=parseFloat(c))};this.storeResult=function(c){c.sum||(c.sum={});c.sum[this.field_]=this.sum_}}}}});return H});